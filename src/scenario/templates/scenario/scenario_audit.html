{% extends 'base.html' %}

{% load static %}
{% block title %}{{ block.super }}{{ header }}{% endblock %}
{% block javascriptOLD %}

{% endblock %}

{% block extra_css %}
<link href="https://cdn.datatables.net/1.10.19/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="https://cdn.datatables.net/buttons/1.5.2/css/buttons.dataTables.min.css" rel="stylesheet">
<style>
    div.dt-buttons{
        padding-top: 5px;
    }
</style>

{% endblock extra_css %}

{% block navbar-left %}
  {% include "_navbar.html" with active_link="audit" %}
{% endblock navbar-left %}

{% block content %}

<div style="padding-top: 20px; vertical-align:middle; line-height: 28px" >
	<span style="font-size: 38px; float:left; ">{{ header }}</span>


	<div style="clear: both;"></div>
<br>
</div>

  <table class="table" id="scenario-audit-table">
    <thead>
      <tr>
        <th>#</th>
        <th>User</th>
        <th>User Type</th>
        <th>Project</th>
        <th>Scenario</th>
        <th>Created</th>
        <th>Last Modified</th>
      </tr>
    </thead>

  </table>

{% endblock %}

{% block new_extra_js %}
    {% include "./includes/extra_js.html" %}
    {% if IIS_APP_ALIAS != '' %}
        <script>
         // add the IIS Application Alias to each of the URL values
            var IIS_APP_ALIAS = "{{ IIS_APP_ALIAS }}";
            if (IIS_APP_ALIAS.length > 0) {
                for (var key in SETTINGS.URLS) {
                    SETTINGS.URLS[key] = '/' + IIS_APP_ALIAS + SETTINGS.URLS[key];
                }
            }
        </script>
    {% endif %}
<script>
            var table;
            $(document).ready(function() {
              var export_columns = [0, 1, 2, 3, 4, 5, 6, 7];

              table = $('#scenario-audit-table').DataTable({
                      'serverSide': true,
                      'ajax': '/api/scenario_audit/?format=datatables', // SETTINGS.URLS.scenario_list + '?format=datatables',
                    'pageLength': 200,
                    "dom": 'Bfrtip',
                    "buttons": [
                        { 'extend': 'copy'},
                        { 'extend': 'csv'},
                        { 'extend': 'excel'},
                    ],
                  'columns': [
                      // Use dot notation to reference nested serializers.
                        {"data": "id", "searchable": false},
                        {"data": "project.user.name", "searchable": true},
                        {"data": "project.user.profile.user_type", "searchable": true},
                        {"data": "project.project_title", "searchable": true},
                        {"data": "scenario_title", "searchable": true},
                        {"data": "create_date", "searchable": true},
                        {"data": "modified_date", "searchable": true},
                  ],
                "columnDefs": [
                  {
                        "searchable": false,
                        "orderable": false,
                        "targets": 0
                  },
                ],
                  "order": [[ 1, 'asc' ]]

                      });
                  });



        table.on( 'order.dt search.dt', function () {
            table.column(0, {search:'applied', order:'applied'}).nodes().each( function (cell, i) {
            cell.innerHTML = i+1;
            t.cell(cell).invalidate('dom');
        } );
    } ).draw();
                {##}
                {##}
                {#var loadTable = function () {#}
                {##}
                {#    var export_columns = [0, 1, 2, 3, 4, 5, 6];#}
                {##}
                {#    var options = {#}
                {#        "serverSide": true,#}
                {#        "ajax": SETTINGS.URLS.scenario_list,#}
                {#        "paging": false,#}
                {#        "info": false,#}
                {#        "dom": 'Bfrtip',#}
                {#        "buttons": [#}
                {#            'copy',#}
                {#            {#}
                {#                'extend': 'csv',#}
                {#                'exportOptions': {'columns': export_columns}#}
                {#            },#}
                {#            'excel',#}
                {#            'pdf',#}
                {#            'print'#}
                {#        ],#}
                {#        "columns": [#}
                {#            {"data": "id", "searchable": false},#}
                {#            // Use dot notation to reference nested serializers.#}
                {#            {"data": "project.user.email", "searchable": true},#}
                {#            {"data": "project.user.profile.user_type", "searchable": true},#}
                {#            {"data": "project_title", "searchable": true},#}
                {#            // {"data": "project_location", "searchable": true},#}
                {#            // {"data": "project_type", "sortable": true},#}
                {#            // {"data": "project_purchase_information", "searchable": true},#}
                {#            // {"data": "project_area",#}
                {#            //     "render": $.fn.dataTable.render.number( ',' ),#}
                {#            //     "searchable": true},#}
                {#            // {"data": "scenario_count", "sortable": true, "searchable": false},#}
                {#        ],#}
                {#        "columnDefs": [#}
                {#            {#}
                {#                "searchable": false,#}
                {#                "orderable": false,#}
                {#                "targets": 0#}
                {#            },#}
                {##}
                {#        ],#}
                {#        "order": [[1, 'asc']]#}
                {#    };#}
                {##}
                {##}
                {#    var table = $('#scenario-audit-table').DataTable(options);#}
                {##}
                {#    table.on('order.dt search.dt', function () {#}
                {#        table.column(0, {search: 'applied', order: 'applied'}).nodes().each(function (cell, i) {#}
                {#            cell.innerHTML = i + 1;#}
                {#        });#}
                {#    }).draw();#}
                {#};#}






        </script>





{% endblock %}
